{"remainingRequest":"/home/dheeraj/Desktop/chess/vue-co/node_modules/babel-loader/lib/index.js!/home/dheeraj/Desktop/chess/vue-co/node_modules/eslint-loader/index.js??ref--13-0!/home/dheeraj/Desktop/chess/vue-co/chessoko/chessoko.js","dependencies":[{"path":"/home/dheeraj/Desktop/chess/vue-co/chessoko/chessoko.js","mtime":1630000329518},{"path":"/home/dheeraj/Desktop/chess/vue-co/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/dheeraj/Desktop/chess/vue-co/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/dheeraj/Desktop/chess/vue-co/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9ob21lL2RoZWVyYWovRGVza3RvcC9jaGVzcy92dWUtY28vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZyb20uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuam9pbi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLm1hdGNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZy5qcyI7CmltcG9ydCB7IHJ1bkZpbHRlciwgdGhyZXNob2xkLCBlZGdlRGV0ZWN0aW9uLCBpblJhbmdlLCBzaGFycGVuLCBncmF5c2NhbGUsIGJyaWdodG5lc3MsIGNvbnRyYXN0IH0gZnJvbSAnLi9pbWFnZU1ldGhvZHMuanMnOwovKiBGb3IgdGVzdGluZwogJCgiI2dvLW9uZSIpLm9uKCJjbGljayIsIGdvT25lKTsKCiBmdW5jdGlvbiBnb09uZSgpIHsKICAgZ2V0U3F1YXJlKCQoIiNmMSIpLnZhbCgpLCAkKCIjZjIiKS52YWwoKSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7ICAgIAogICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7ICAgICAgICAgICAgCiAgIH0pOwogfQoKKi8KCnZhciBwcm9jZXNzZWRJbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJJTUciKTsKcHJvY2Vzc2VkSW1nLmlkID0gImJpbmFyeUltZyI7CnZhciBwaWVjZUltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIklNRyIpOwpwaWVjZUltZy5pZCA9ICJwaWVjZUltZyI7CnZhciBmZW4gPSBBcnJheS5mcm9tKEFycmF5KDgpLCBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIG5ldyBBcnJheSg4KTsKfSk7CnZhciBpdGVyYXRpb24gPSAwOwpleHBvcnQgZnVuY3Rpb24gZ2V0RmVuKCkgewogIHZhciBzdWJqZWN0SW1hZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6ICJjLWltYWdlIjsKICB2YXIgY2FsbGJhY2tGdW5jdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkOwogIHZhciBpbWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzdWJqZWN0SW1hZ2UpOwogIHZhciBjb250cmFzdGVkSW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiSU1HIik7CiAgY29udHJhc3RlZEltZy5zcmMgPSBjb250cmFzdChpbWcpOwoKICBjb250cmFzdGVkSW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgIHByb2Nlc3NlZEltZy5zcmMgPSB0aHJlc2hvbGQoY29udHJhc3RlZEltZyk7CiAgfTsKCiAgcGllY2VJbWcuc3JjID0gZWRnZURldGVjdGlvbihpbWcpOwoKICBwcm9jZXNzZWRJbWcub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgY29uc29sZS5sb2coInByb2Nlc3NlZEltZyIsIHByb2Nlc3NlZEltZy53aWR0aCk7CiAgfTsKCiAgcGllY2VJbWcub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgY29uc29sZS5sb2coInBpZWNlSW1nIiwgcGllY2VJbWcud2lkdGgpOwogICAgaGl0KHN1YmplY3RJbWFnZSwgY2FsbGJhY2tGdW5jdGlvbik7CiAgfTsKfQp2YXIgcGllY2VDbGFzc2lmaWVyID0gbWw1LmltYWdlQ2xhc3NpZmllcignY2hlc3Nva28vcGllY2UtbW9kZWwvbW9kZWwuanNvbicsIGZ1bmN0aW9uICgpIHsKICBjb25zb2xlLmxvZygiTG9hZGVkIHBpZWNlIG1vZGVsIik7Cn0pOwp2YXIgbGRlQ2xhc3NpZmllciA9IG1sNS5pbWFnZUNsYXNzaWZpZXIoJ2NoZXNzb2tvL2xkZS1tb2RlbC9tb2RlbC5qc29uJywgZnVuY3Rpb24gKCkgewogIGNvbnNvbGUubG9nKCJMb2FkZWQgTERFIG1vZGVsIik7Cn0pOwoKZnVuY3Rpb24gaGl0KCkgewogIHZhciBJbWFnZUVsZW1lbnRJZCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogImMtaW1hZ2UiOwogIHZhciBjYWxsYmFjayA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkOwogIC8vIGxvb3Agc2hvdWxkIGJlIHdyaXR0ZW4gaGVyZQogIHZhciBpc0ltYWdlUHJvY2Vzc2VkID0gdHJ1ZTsKCiAgaWYgKGlzSW1hZ2VQcm9jZXNzZWQpIHsKICAgIGl0ZXJhdGlvbiA9IDA7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCA4OyBpKyspIHsKICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHsKICAgICAgICBnZXRTcXVhcmUoaSwgaikudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXN1bHQpOwogICAgICAgICAgZmVuW3Jlc3VsdFswXV1bcmVzdWx0WzFdXSA9IHJlc3VsdFsyXTsKICAgICAgICAgIGl0ZXJhdGlvbisrOwoKICAgICAgICAgIGlmIChpdGVyYXRpb24gPiA2MykgewogICAgICAgICAgICBjb25zb2xlLmxvZyhmZW4pOwogICAgICAgICAgICBwcm9jZXNzRmVuKGZlbiwgY2FsbGJhY2spOwogICAgICAgICAgfSAvLyBjb25zb2xlLmNvdW50KCk7CgogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSBlbHNlIHsKICAgIGNvbnNvbGUubG9nKCJQcmVjZWRlY2UgaXNzdWUiKTsKICB9Cn0KCmZ1bmN0aW9uIGdldFNxdWFyZShfeCwgX3gyKSB7CiAgcmV0dXJuIF9nZXRTcXVhcmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX2dldFNxdWFyZSgpIHsKICBfZ2V0U3F1YXJlID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKGksIGopIHsKICAgIHZhciBjeCwgY3ksIHBpZWNlLCBjdXJyZW50U3F1YXJlLCBjdXJyZW50UGllY2UsIG15UHJvbWlzZSwgY29sOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBjeCA9IHByb2Nlc3NlZEltZy53aWR0aCAvIDg7CiAgICAgICAgICAgIGN5ID0gcHJvY2Vzc2VkSW1nLmhlaWdodCAvIDg7CiAgICAgICAgICAgIHBpZWNlID0gIjAiOwogICAgICAgICAgICBjdXJyZW50U3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiSU1HIik7CiAgICAgICAgICAgIGN1cnJlbnRTcXVhcmUuc3JjID0gZ2V0Q2xpcHBlZFJlZ2lvbihwcm9jZXNzZWRJbWcsIGkgKiBjeCwgaiAqIGN5LCBjeCwgY3kpOwogICAgICAgICAgICBjdXJyZW50UGllY2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJJTUciKTsKICAgICAgICAgICAgY3VycmVudFBpZWNlLnNyYyA9IGdldENsaXBwZWRSZWdpb24ocGllY2VJbWcsIGkgKiBjeCwgaiAqIGN5LCBjeCwgY3kpOwogICAgICAgICAgICBteVByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAobXlSZXNvbHZlLCBteVJlamVjdCkgewogICAgICAgICAgICAgIGN1cnJlbnRTcXVhcmUub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIGd1ZXNzMSA9IGxkZUNsYXNzaWZpZXIuY2xhc3NpZnkoY3VycmVudFNxdWFyZSwgZnVuY3Rpb24gKGVyciwgcmVzdWx0cykgewogICAgICAgICAgICAgICAgICAvLyBsZCA9IHJlc3VsdHNbMF0ubGFiZWw7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGksIGosIHJlc3VsdHNbMF0pOwoKICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdHNbMF0ubGFiZWwgIT0gImVtcHR5IikgewogICAgICAgICAgICAgICAgICAgIHBpZWNlQ2xhc3NpZmllci5jbGFzc2lmeShjdXJyZW50UGllY2UsIGZ1bmN0aW9uIChlcnIsIHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgICAgcGllY2UgPSByZXN1bHRbMF0ubGFiZWw7CgogICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdHNbMF0ubGFiZWwgPT0gImRhcmsiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBpZWNlID0gcGllY2UudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgid3JhcHBlciIpLmFwcGVuZENoaWxkKGN1cnJlbnRTcXVhcmUpOwogICAgICAgICAgICAgICAgICAgICAgbXlSZXNvbHZlKFtqLCBpLCBwaWVjZV0pOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIC8vIGZlbltpXVtqXSA9ICIwIjsKICAgICAgICAgICAgICAgICAgICBteVJlc29sdmUoW2osIGksICIwIl0pOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEwOwogICAgICAgICAgICByZXR1cm4gbXlQcm9taXNlOwoKICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgIGNvbCA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIGNvbCk7CgogICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlKTsKICB9KSk7CiAgcmV0dXJuIF9nZXRTcXVhcmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gZ2V0Q2xpcHBlZFJlZ2lvbihpbWFnZSwgeCwgeSwgd2lkdGgsIGhlaWdodCkgewogIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKSwKICAgICAgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7CiAgY2FudmFzLndpZHRoID0gd2lkdGg7CiAgY2FudmFzLmhlaWdodCA9IGhlaWdodDsKICBjdHguZHJhd0ltYWdlKGltYWdlLCB4LCB5LCB3aWR0aCwgaGVpZ2h0LCAwLCAwLCB3aWR0aCwgaGVpZ2h0KTsKICB2YXIgaW1hZ2VPZkNsaXBwZWRQYXJ0ID0gY2FudmFzLnRvRGF0YVVSTCgiaW1hZ2UvcG5nIik7CiAgcmV0dXJuIGltYWdlT2ZDbGlwcGVkUGFydDsKfSAvLyAvLyBNYWtlIGEgcHJlZGljdGlvbiB3aXRoIGEgc2VsZWN0ZWQgaW1hZ2UKLy8gYXN5bmMgZnVuY3Rpb24gcHJlZGljdFBpZWNlKGltZzEpIHsKLy8gIHZhciB0ZW1wSW1nMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIklNRyIpOwovLyAgdGVtcEltZzEuc3JjID0gaW1nMTsKLy8gICB2YXIgcGllY2UgPSAiMCI7Ci8vICAgdmFyIGd1ZXNzMSA9IGF3YWl0IGNsYXNzaWZpZXIuY2xhc3NpZnkodGVtcEltZzEsIChlcnIsIHJlc3VsdHMpID0+IHsKLy8gICAgICAgcGllY2UgPSByZXN1bHRzWzBdLmxhYmVsOwovLyAgICAgICAvLyBjb25zb2xlLmxvZyhwaWVjZSk7Ci8vICAgfSk7Ci8vICAgcmV0dXJuIHBpZWNlOwovLyB9CgoKZnVuY3Rpb24gcHJvY2Vzc0ZlbihmZW5BcnJheSwgY2FsbGJhY2spIHsKICB2YXIgZmVuU3RyID0gIiI7CiAgZmVuQXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgaXRlbSA9IGl0ZW0uam9pbigiIik7CiAgICBmZW5TdHIgPSBmZW5TdHIgKyAiLyIgKyBpdGVtOwogIH0pOwogIHZhciBwYXR0MSA9IC9cZHsxLH0vZzsKICB2YXIgcmVzdWx0ID0gZmVuU3RyLm1hdGNoKHBhdHQxKTsKICByZXN1bHQuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgZmVuU3RyID0gZmVuU3RyLnJlcGxhY2UoaXRlbS50b1N0cmluZygpLCBpdGVtLnRvU3RyaW5nKCkubGVuZ3RoKTsKICB9KTsKICBjb25zb2xlLmxvZygiaHR0cHM6Ly9saWNoZXNzLm9yZy9lZGl0b3IiICsgZmVuU3RyICsgIl93X0tRa3FfLV8wXzEiKTsKICBjYWxsYmFjayhmZW5TdHIpOwp9CgpmdW5jdGlvbiBtb2RlbExvYWRlZCgpIHsKICBjb25zb2xlLmxvZygnTW9kZWwgTG9hZGVkIScpOwp9CgpmdW5jdGlvbiBjYWxsYmFja0Z1bmN0aW9uKGZlblN0cmluZykgewogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmZW4iKS5pbm5lckhUTUwgPSBmZW5TdHJpbmc7Cn0="},{"version":3,"sources":["/home/dheeraj/Desktop/chess/vue-co/chessoko/chessoko.js"],"names":["runFilter","threshold","edgeDetection","inRange","sharpen","grayscale","brightness","contrast","processedImg","document","createElement","id","pieceImg","fen","Array","from","iteration","getFen","subjectImage","callbackFunction","img","getElementById","contrastedImg","src","onload","console","log","width","hit","pieceClassifier","ml5","imageClassifier","ldeClassifier","ImageElementId","callback","isImageProcessed","i","j","getSquare","then","result","processFen","cx","cy","height","piece","currentSquare","getClippedRegion","currentPiece","myPromise","Promise","myResolve","myReject","guess1","classify","err","results","label","toLowerCase","appendChild","col","image","x","y","canvas","ctx","getContext","drawImage","imageOfClippedPart","toDataURL","fenArray","fenStr","forEach","item","join","patt1","match","replace","toString","length","modelLoaded","fenString","innerHTML"],"mappings":"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","sourcesContent":["import { runFilter, threshold, edgeDetection, inRange, sharpen, grayscale, brightness, contrast } from './imageMethods.js';\n\n\n/* For testing\n $(\"#go-one\").on(\"click\", goOne);\n\n function goOne() {\n   getSquare($(\"#f1\").val(), $(\"#f2\").val()).then(function (result) {    \n     console.log(result);            \n   });\n }\n\n*/\n\n var processedImg = document.createElement(\"IMG\");\n processedImg.id = \"binaryImg\";\n\n var pieceImg = document.createElement(\"IMG\");\n pieceImg.id = \"pieceImg\";\n\n var fen =  Array.from(Array(8), () => new Array(8));\n var iteration = 0;\n\n\n\n export function getFen(subjectImage = \"c-image\", callbackFunction) {\n\n   var img = document.getElementById(subjectImage); \n\n   var contrastedImg = document.createElement(\"IMG\");\n   contrastedImg.src = contrast(img);  \n\n   contrastedImg.onload = function () {\n     processedImg.src = threshold(contrastedImg); \n   }\n\n\n   pieceImg.src = edgeDetection(img);\n\n   processedImg.onload = function () {\n     console.log(\"processedImg\", processedImg.width);\n   }\n\n   pieceImg.onload = function () {\n     console.log(\"pieceImg\", pieceImg.width);\n\n     hit(subjectImage, callbackFunction);\n   }\n\n } \n\n const pieceClassifier = ml5.imageClassifier('chessoko/piece-model/model.json', () => {\n   console.log(\"Loaded piece model\");\n });\n const ldeClassifier = ml5.imageClassifier('chessoko/lde-model/model.json', () => {\n   console.log(\"Loaded LDE model\");\n });\n\n\n\n         function hit(ImageElementId = \"c-image\", callback) { // loop should be written here\n\n           var isImageProcessed = true;\n\n           if(isImageProcessed) {\n             iteration = 0;\n\n             for(var i = 0; i < 8; i++) {\n               for(var j = 0; j < 8; j++) {\n                 getSquare(i,j).then(function (result) {\n                  // console.log(result);\n                  fen[result[0]][result[1]] = result[2];\n                  iteration++;\n                  if(iteration >63) {\n                    console.log(fen);\n                    processFen(fen, callback);\n\n                  }\n                  // console.count();\n                });\n\n               }\n\n             }  \n           } else { \n             console.log(\"Precedece issue\");\n           }\n\n\n         }\n\n\n         async function getSquare(i,j) {\n\n           let cx = (processedImg.width/8);\n           let cy = (processedImg.height/8);\n           var piece = \"0\";\n\n\n\n\n           var currentSquare = document.createElement(\"IMG\"); \n           currentSquare.src = getClippedRegion(processedImg, i*cx, j*cy, cx, cy);\n           var currentPiece = document.createElement(\"IMG\");\n           currentPiece.src = getClippedRegion(pieceImg, i*cx, j*cy, cx, cy);\n\n\n           let myPromise = new Promise(function(myResolve, myReject) { \n\n             currentSquare.onload = function () {\n               var guess1 = ldeClassifier.classify(currentSquare, (err, results) => {\n                  // ld = results[0].label;\n                  console.log(i,j,results[0]);\n                  if(results[0].label != \"empty\") {\n                    pieceClassifier.classify(currentPiece, (err, result) => {\n\n                      piece = result[0].label;\n\n                      if(results[0].label == \"dark\") {\n                        piece = piece.toLowerCase();  \n                      }\n                      document.getElementById(\"wrapper\").appendChild(currentSquare);   \n                      myResolve([j, i, piece]);\n                    });                  \n                  } else {\n                  // fen[i][j] = \"0\";\n\n                  myResolve([j,i,\"0\"]);\n                } \n\n              });\n             }\n\n           });\n\n           var col = await myPromise;\n\n           return col;\n\n         }\n\n\n\n\n         function getClippedRegion(image, x, y, width, height) {\n\n           var canvas = document.createElement('canvas'),\n           ctx = canvas.getContext('2d');\n\n           canvas.width = width;\n           canvas.height = height;\n           ctx.drawImage(image, x, y, width, height,  0, 0, width, height);\n\n           var imageOfClippedPart = canvas.toDataURL(\"image/png\");\n           return imageOfClippedPart;\n         }\n\n\n\n\n// // Make a prediction with a selected image\n// async function predictPiece(img1) {\n//  var tempImg1 = document.createElement(\"IMG\");\n//  tempImg1.src = img1;\n//   var piece = \"0\";\n//   var guess1 = await classifier.classify(tempImg1, (err, results) => {\n//       piece = results[0].label;\n//       // console.log(piece);\n//   });\n\n//   return piece;\n\n// }\n\n\n\nfunction processFen(fenArray, callback) {\n  var fenStr = \"\";\n\n  fenArray.forEach((item) => {\n\n    item = item.join(\"\");\n\n    fenStr = fenStr + \"/\" + item;\n\n  });\n\n  var patt1 = /\\d{1,}/g; \n  var result = fenStr.match(patt1);\n  result.forEach((item) => {\n    fenStr = fenStr.replace(item.toString(), item.toString().length); \n  });\n\n  console.log(\"https://lichess.org/editor\" + fenStr + \"_w_KQkq_-_0_1\");\n  callback(fenStr);\n}\n\n\nfunction modelLoaded() {\n  console.log('Model Loaded!');\n}\n\nfunction callbackFunction(fenString) {\n  document.getElementById(\"fen\").innerHTML = fenString;\n}"]}]}